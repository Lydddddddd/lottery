<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <title>ç®€å•è½¬ç›˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        html,
        body {
            font-family: 'PingFang SC', 'Helvetica Neue', sans-serif;
            /* è®¾ç½®ä¸ºè‹¹æ–¹å­—ä½“ */
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0;
            padding: 0;
        }

        ul {
            list-style: none;
        }

        .turntable-title {
            text-align: center;
            font-size: 28px;
            color: #f1c971;
            margin: 30px auto;
            animation: pulse 1.6s infinite ease-in-out;
        }

        @keyframes white-to-yellow {
            0% {
                background: #fff;
            }

            100% {
                background: #d7a945;
            }
        }

        @keyframes heartbeat {
            0% {
                transform: scale(1);
            }

            25% {
                transform: scale(0.8);
            }

            50% {
                transform: scale(1.2);
            }

            75% {
                transform: scale(0.9);
            }

            100% {
                transform: scale(1);
            }
        }

        .turntable-wrap {
            position: relative;
            overflow: hidden;
            width: 280px;
            height: 280px;
            border: 7px solid #b2a98d;
            border-radius: 50%;
            box-shadow: 0 0 20px #b2a98d;
            transform-origin: center;
            transform: scale(1);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .turntable-wrap .light {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #e0ddd1;
            animation: rotate 5s linear infinite;
        }

        .turntable-wrap .light span {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            margin: 0 auto;
            width: 10px;
            height: 100%;
            border-radius: 50%;
            transform-origin: center center;
        }

        .turntable-wrap .light span:before {
            content: '';
            position: absolute;
            top: 5px;
            left: 0;
            right: 0;
            margin: 0 auto;
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .turntable-wrap .light span:nth-of-type(even):before {
            background: #fff;
            animation: white-to-yellow 1s linear infinite;
        }

        .turntable-wrap .light span:nth-of-type(odd):before {
            background: #d7a945;
            animation: white-to-yellow 1s linear reverse infinite;
        }

        .turntable-wrap .turntable {
            position: absolute;
            margin: 20px;
            width: 240px;
            height: 240px;
            border-radius: 50%;
            background: #fff;
        }

        .turntable-wrap .turntable .bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #fff;
            border: 1px solid #dfd8be;
            border-radius: 50%;
            transform: rotate(90deg);
        }

        .turntable-wrap .turntable .bg li {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            margin: 0 auto;
            width: 1px;
            height: 100%;
            background: #dfd8be;
            transform-origin: center center;
        }

        .turntable-wrap .turntable .gift {
            position: relative;
            width: 100%;
            height: 100%;
            transform: rotate(45deg);
        }

        .turntable-wrap .turntable .gift li {
            position: absolute;
            top: 5%;
            left: 5%;
            width: 45%;
            height: 45%;
            transform-origin: right bottom;
            background-size: cover;
            background-position: center;
        }

        .turntable-wrap .turntable .gift li span {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: block;
            width: 50px;
            height: 70px;
            margin: auto;
            background: yellow;
            transform: rotate(-45deg);
            text-align: center;
            line-height: 80px;
            border-radius: 5px;
            background: #f23c3c;
            color: #fff;
            font-size: 24px;
        }

        .turntable-wrap .turntable .gift li.no-gift span {
            background: #fff;
            line-height: 70px;
            color: #bfa74f;
            font-size: 12px;
        }

        .turntable-wrap .pointer {
            box-sizing: border-box;
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            margin: -23px auto;
            width: 46px;
            height: 46px;
            border-radius: 50%;
            background: #fff;
            border: 5px solid #fff;
            box-shadow: 0 0 0 5px #b9a046;
            text-align: center;
            line-height: 16px;
            color: #b9a046;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
        }

        .turntable-wrap .pointer:before {
            content: '';
            position: absolute;
            top: -58px;
            left: 0;
            right: 0;
            margin: 0 auto;
            width: 0;
            border-style: solid;
            border-color: transparent transparent #b9a046 transparent;
            border-width: 25px 10px 25px 10px;
        }

        footer {
            margin-top: 20px;
            position: fixed;
            left: 0;
            right: 0;
            bottom: 10px;
            display: flex;
            justify-content: center;
            font-size: 14px;
            color: #333;
        }

        /* é€‚é…æ‰‹æœºå±å¹• */
        @media screen and (max-width: 768px) {
            .turntable-wrap {
                width: 240px;
                height: 240px;
            }

            .turntable-wrap .turntable {
                width: 200px;
                height: 200px;
            }

            .turntable-wrap .pointer {
                width: 40px;
                height: 40px;
                margin: -20px auto;
            }

            .turntable-title {
                font-size: 22px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="turntable-title">ğŸ‰ lssç”Ÿæ—¥ç¤¼ç‰©å¤§è½¬ç›˜ ğŸ‰</div>
        <div class="turntable-wrap">
            <div class="light" id="turntable_light"></div>
            <div class="turntable" id="turntable">
                <ul class="bg" id="turntable_bg"></ul>
                <ul class="gift" id="turntable_gift"></ul>
            </div>
            <div class="pointer disabled" id="turntable_pointer">ç‚¹å‡»æŠ½å¥–</div>
        </div>
        <!-- æ·»åŠ å¤‡æ¡ˆå· -->
        <footer>
            <p>æµ™ICPå¤‡2025157761å·</p>
        </footer>
    </div>

    <!-- æŠ½å¥–ç»“æœå¼¹çª— -->
    <div id="resultModal"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.5); justify-content:center; align-items:center; z-index:9999;">
        <div
            style="background:#fff; padding:20px 30px; border-radius:10px; text-align:center; max-width:80%; box-shadow:0 0 10px rgba(0,0,0,0.3);">
            <img id="resultImage" src="" style="width:150px; height:auto; margin-bottom:15px;" />
            <div id="resultText" style="font-size:18px; color:#333;"></div>
            <button onclick="document.getElementById('resultModal').style.display='none'"
                style="margin-top:15px; padding:5px 15px; background:#f23c3c; color:#fff; border:none; border-radius:5px; cursor:pointer;">å…³é—­</button>
        </div>
    </div>

    <script>
        // å•ä¾‹æ¨¡å¼ï¼Œè½¬ç›˜å”¯ä¸€ï¼Œç”¨å¯¹è±¡å­—é¢é‡æ–¹å¼è¡¨ç¤º
        let turntable = {
            itemNum: 6, // è½¬ç›˜å¹³å‡åˆ†å‡ å—

            lightNum: 18, // è½¬ç›˜ä¸Šçš„ç¯
            light: null, // è½¬ç›˜æ—‹è½¬ç¯å®¹å™¨

            turntable: null, // è½¬ç›˜

            bg: null, // è½¬ç›˜èƒŒæ™¯

            gift: null, // è½¬ç›˜ä¸Šçš„ä¸­å¥–ç»“æœå›¾

            pointer: null, // è½¬ç›˜æŒ‡é’ˆ

            lottery: [], // ä¸­å¥–æ•°æ®

            typeMap: { 1: 'Â¥', 2: 'è°¢è°¢å‚ä¸' },
            typeClassMap: { 1: '', 2: 'no-gift' },

            isGoing: false, // æ¸¸æˆæ˜¯å¦å¼€å§‹

            init() {
                if (!this.lottery.length) {
                    this.pointer.style.display = 'none';
                    throw new Error('è¯·è®¾ç½®ä¸­å¥–ç»“æœæ•°æ®');
                }

                // åˆå§‹åŒ–ç¯
                let lightFragment = document.createDocumentFragment();
                for (let i = 0; i < this.lightNum; i++) {
                    let lightItem = document.createElement('span');
                    let deg = (360 / this.lightNum) * i
                    lightItem.style.transform = `rotate(${deg}deg)`;
                    lightFragment.appendChild(lightItem);
                }
                this.light.appendChild(lightFragment);



                // åˆå§‹åŒ–è½¬ç›˜èƒŒæ™¯ã€è½¬ç›˜ä¸Šçš„ä¸­å¥–å›¾ï¼ˆç”¨ä¸åŒèƒŒæ™¯è‰²ä»£æ›¿ï¼‰
                let bgFragment = document.createDocumentFragment();
                let bgItemWidth = this.bg.offsetWidth / this.num;
                let giftFragment = document.createDocumentFragment();

                for (let i = 0; i < this.itemNum; i++) {
                    let bgItem = document.createElement('li');
                    let deg = (360 / this.itemNum) * i;
                    bgItem.style.transform = `rotate(${deg}deg)`;
                    bgFragment.appendChild(bgItem);

                    let giftItem = document.createElement('li');
                    giftItem.style.transform = `rotate(${deg}deg)`;  // ç¡®ä¿æ—‹è½¬è§’åº¦ä¸è½¬ç›˜åˆ†é…ä¸€è‡´
                    giftItem.className = this.typeClassMap[this.lottery[i].type];

                    // åˆ›å»ºä¸€ä¸ªç”¨äºå±•ç¤ºå›¾ç‰‡çš„å­å…ƒç´ 
                    let imgWrapper = document.createElement('div');
                    imgWrapper.style.position = 'absolute';
                    imgWrapper.style.top = '50%';
                    imgWrapper.style.left = '50%';
                    imgWrapper.style.transform = 'translate(-50%, -50%)'; // å°†å›¾ç‰‡å±…ä¸­

                    // æ ¹æ®lotteryä¸­æ¯ä¸ªå¥–å“çš„sizeå±æ€§æ§åˆ¶å›¾ç‰‡å¤§å°
                    let size = this.lottery[i].size;
                    imgWrapper.style.width = size.width;  // æ§åˆ¶å›¾ç‰‡å¤§å°
                    imgWrapper.style.height = size.height; // æ§åˆ¶å›¾ç‰‡å¤§å°

                    // è®¾ç½®èƒŒæ™¯å›¾ç‰‡ï¼Œå¹¶æ·»åŠ æ—‹è½¬æ•ˆæœ
                    imgWrapper.style.backgroundImage = `url('${this.lottery[i].image}')`; // è®¾ç½®èƒŒæ™¯å›¾ç‰‡
                    imgWrapper.style.backgroundSize = '80%';  // å›¾ç‰‡é“ºæ»¡æ•´ä¸ªå®¹å™¨
                    imgWrapper.style.backgroundPosition = 'center';  // å›¾ç‰‡å±…ä¸­æ˜¾ç¤º
                    imgWrapper.style.backgroundRepeat = 'no-repeat'; // é˜²æ­¢å›¾ç‰‡é‡å¤

                    // ç¡®ä¿å›¾ç‰‡å›´ç»•è‡ªèº«ä¸­å¿ƒæ—‹è½¬
                    imgWrapper.style.transformOrigin = 'center';
                    imgWrapper.style.transform += ' rotate(-45deg)';  // å‘å·¦æ—‹è½¬45åº¦

                    // åˆ›å»ºä¸€ä¸ªæ˜¾ç¤ºå¥–å“åç§°çš„å…ƒç´ 
                    let prizeName = document.createElement('div');
                    prizeName.style.position = 'absolute';
                    prizeName.style.top = '50%';  // å°†åç§°å‚ç›´å±…ä¸­
                    prizeName.style.left = '100%';  // å°†åç§°æ”¾ç½®åœ¨å›¾ç‰‡çš„å³è¾¹ï¼ˆå¯ä»¥æ”¹ä¸ºleft: '0%'æ”¾å·¦è¾¹ï¼‰
                    prizeName.style.transform = 'translateX(-50%)'; // å‚ç›´å±…ä¸­
                    prizeName.style.fontSize = '14px'; // å¥–å“åç§°å­—ä½“å¤§å°
                    prizeName.style.color = '#fff'; // å¥–å“åç§°å­—ä½“é¢œè‰²
                    prizeName.innerText = this.lottery[i].name; // ä½¿ç”¨å¥–å“çš„åç§°

                    // å°†å›¾ç‰‡å’Œåç§°æ·»åŠ åˆ°giftItem
                    giftItem.appendChild(imgWrapper);
                    // giftItem.appendChild(prizeName);  // æ·»åŠ å¥–å“åç§°

                    giftFragment.appendChild(giftItem);
                }

                this.bg.appendChild(bgFragment);
                this.gift.appendChild(giftFragment);

                // ç»™ç‚¹å‡»æŠ½å¥–æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶
                this.pointer.onclick = this.gameStart.bind(this)
            },

            gameStart() {
                if (this.isGoing) {
                    return
                }
                this.isGoing = true;

                // 1. éšæœºä¸­å¥–ç»“æœ
                let randomRate = ~~(Math.random() * 100)
                let num = 0
                this.lottery.forEach(item => {
                    item.min = num;
                    num += item.rate;
                    item.max = num;
                })
                let res = this.lottery.filter(item => {
                    return randomRate >= item.min && randomRate < item.max;
                })[0];

                let itemAngle = 360 / this.lottery.length;
                let correctAngle = 240; // å®æµ‹åç§»è§’åº¦
                let rotateItemDeg = (res.location - 1) * itemAngle + correctAngle;
                let rotate = rotateItemDeg + 5 * 360;
                let rotateSpeed = (rotateItemDeg / 360 * 1 + 5).toFixed(2);

                this.turntable.removeAttribute('style');
                setTimeout(() => {
                    this.turntable.style.transform = `rotate(${rotate}deg)`;
                    this.turntable.style.transition = `transform ${rotateSpeed}s ease-out`;
                }, 10)

                setTimeout(() => {
                    this.isGoing = false;
                    console.log('ä¸­å¥–ç»“æœï¼š', randomRate, res, this.typeMap[res.type]);

                    // å¼¹å‡ºä¸­å¥–æç¤ºæ¡†
                    const modal = document.getElementById('resultModal');
                    const resultImage = document.getElementById('resultImage');
                    const resultText = document.getElementById('resultText');
                    resultImage.src = res.image;
                    resultText.innerText = res.name || (res.type === 1 ? 'DJI Osmo Pocket 3\næ­å–œä½ ä¸­å¥–äº†ï¼\n è¯·å‰å¾€ä¸‡è±¡ååºœæ‰¾lqqé¢†å–å¥–å“ï¼' : 'è°¢è°¢å‚ä¸');
                    modal.style.display = 'flex';
                }, rotateSpeed * 1000);
            }
        }

        let lottery = [
            {
                location: 1,
                type: 1,
                rate: 0,
                image: './images/maybach.png',
                // name: 'è°¢è°¢å‚ä¸',
                size: { width: '100%', height: '100%' } // æ¯ä¸ªå¥–å“çš„å¤§å°
            },
            {
                location: 2,
                type: 1,
                rate: 100,
                image: './images/pocket3.jpg',
                // name: 'è°¢è°¢å‚ä¸',
                size: { width: '58%', height: '58%' } // æ¯ä¸ªå¥–å“çš„å¤§å°
            },
            {
                location: 3,
                type: 1,
                rate: 0,
                image: './images/16.png',
                // name: 'è°¢è°¢å‚ä¸',
                size: { width: '75%', height: '75%' } // æ¯ä¸ªå¥–å“çš„å¤§å°
            },
            {
                location: 4,
                type: 1,
                rate: 0,
                image: './images/mac.png',
                // name: 'è°¢è°¢å‚ä¸',
                size: { width: '75%', height: '75%' } // æ¯ä¸ªå¥–å“çš„å¤§å°
            },
            {
                location: 5,
                type: 1,
                rate: 0,
                image: './images/s10.jpg',
                // name: 'è°¢è°¢å‚ä¸',
                size: { width: '63%', height: '63%' } // æ¯ä¸ªå¥–å“çš„å¤§å°
            },
            {
                location: 6,
                type: 1,
                rate: 0,
                image: './images/ipad.png',
                name: 'è°¢è°¢å‚ä¸',
                size: { width: '140%', height: '140%' } // æ¯ä¸ªå¥–å“çš„å¤§å°
            }
        ];

        turntable.turntable = document.querySelector('#turntable');
        turntable.light = document.querySelector('#turntable_light');
        turntable.bg = document.querySelector('#turntable_bg');
        turntable.gift = document.querySelector('#turntable_gift');
        turntable.pointer = document.querySelector('#turntable_pointer');
        turntable.lottery = lottery;
        turntable.init();
    </script>
</body>


</html>